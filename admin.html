<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard ‚Äî Borodina.Pilates</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #111; color: #0f0; font-family: 'JetBrains Mono', monospace; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: #222; border: 1px solid #333; padding: 20px; border-radius: 8px; }
        h1, h2 { color: #fff; margin-top: 0; }
        .big-num { font-size: 3em; font-weight: bold; color: #fff; }
        .label { color: #888; font-size: 0.9em; }
        .alert { color: #ff3b30; }
        .good { color: #34c759; }
        
        /* –¢–∞–±–ª–∏—Ü–∞ */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { text-align: left; color: #666; border-bottom: 1px solid #333; padding: 5px; }
        td { padding: 8px 5px; border-bottom: 1px solid #222; color: #ddd; }
    </style>
</head>
<body>

    <h1>üöÄ Mission Control Center</h1>
    <div id="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>

    <div class="grid" id="dashboard" style="display:none;">
        
        <!-- –ë–ª–æ–∫ 1: –ü–æ–¥–ø–∏—Å–∫–∏ -->
        <div class="card">
            <h2>üë• –ü–æ–¥–ø–∏—Å–∫–∏</h2>
            <div class="big-num" id="active-subs">-</div>
            <div class="label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
            <hr style="border-color:#333">
            <p>–ù–æ–≤—ã—Ö –∑–∞ 30 –¥–Ω–µ–π: <span id="new-subs" class="good">-</span></p>
            <p>–ò—Å—Ç–µ–∫–ª–æ (–ê—Ä—Ö–∏–≤): <span id="expired-subs" style="color:#666">-</span></p>
        </div>

        <!-- –ë–ª–æ–∫ 2: –ö–∞–Ω–∞–ª—ã (–°–≤–µ—Ä–∫–∞) -->
        <div class="card">
            <h2>üì¢ –¢–µ–ª–µ–≥—Ä–∞–º –ö–∞–Ω–∞–ª—ã</h2>
            <table>
                <thead><tr><th>–ö–∞–Ω–∞–ª</th><th>–í –±–∞–∑–µ</th><th>–í —Ä–µ–∞–ª–µ</th><th>–†–∞–∑–Ω–∏—Ü–∞</th></tr></thead>
                <tbody id="channels-table">
                    <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ -->
                </tbody>
            </table>
            <p class="label" style="margin-top:10px">–ï—Å–ª–∏ "–í —Ä–µ–∞–ª–µ" > "–í –±–∞–∑–µ", –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å "–∑–∞–π—Ü—ã".</p>
        </div>

        <!-- –ë–ª–æ–∫ 3: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
        <div class="card">
            <h2>üõ° Security</h2>
            <div class="big-num alert" id="banned-count">-</div>
            <div class="label">–ó–∞–±–∞–Ω–µ–Ω–æ –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π</div>
            <p style="margin-top:15px">–ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç:</p>
            <div id="last-incident" style="font-size:0.8em; color:#aaa">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <!-- –ë–ª–æ–∫ 4: –°–∞–π—Ç -->
        <div class="card">
            <h2>üåê –°–∞–π—Ç (–¢—Ä–∞—Ñ–∏–∫)</h2>
            <div class="big-num" id="site-today">-</div>
            <div class="label">–í–∏–∑–∏—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è</div>
            <p>–ó–∞ 7 –¥–Ω–µ–π: <span id="site-week">-</span></p>
        </div>

    </div>

    <script>
        const API_URL = 'https://n8n.borodin.live/webhook/admin-stats';

        async function init() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json();

                // 1. –ü–æ–¥–ø–∏—Å–∫–∏
                document.getElementById('active-subs').textContent = data.subscriptions.active;
                document.getElementById('expired-subs').textContent = data.subscriptions.expired;
                document.getElementById('new-subs').textContent = '+' + data.subscriptions.new_30d;

                // 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
                document.getElementById('banned-count').textContent = data.security.banned;
                document.getElementById('last-incident').textContent = "–î–∞–Ω–Ω—ã–µ –æ —Å–ª–∏–≤–∞—Ö..."; // –ú–æ–∂–Ω–æ –¥–æ–ø–∏–ª–∏—Ç—å

                // 3. –°–∞–π—Ç
                document.getElementById('site-today').textContent = data.website.today;
                document.getElementById('site-week').textContent = data.website.week;

                // 4. –ö–∞–Ω–∞–ª—ã (–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏)
                // –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, API –≤–µ—Ä–Ω—É–ª –æ–±—ä–µ–∫—Ç channels: { beginner: {db: 10, tg: 12}, ... }
                // –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç n8n
                // const table = document.getElementById('channels-table');
                // ... –∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ ...

                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboard').style.display = 'grid';

            } catch (e) {
                document.getElementById('loading').innerText = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + e.message;
            }
        }

        init();
    </script>
</body>
</html>